Exploratory Data Analysis by Laura Uzcategui
========================================================

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(dplyr)
library(GGally)
library(Hmisc)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wine <- read.csv('wineQualityWhites.csv')
```

# Summary 
  The following project for exploratory data analysis is based on a White Wine 
  quality data provided on the Research paper 
  [Modeling Wine Preferences from 
  Physicochemical Properties using Fuzzy Techniques](http://www.scitepress.org/Papers/2015/55519/55519.pdf)
  on which the purpose was to predict the human test preference based on 
  physico chemical properties of wine. 
  
  The data was obtained from a variety of wines with origin in Portugal, 
  specifically "Vinho Verde".

# Univariate Plots Section

Lets explore how the data looks by using the head function, which will show us the first rows. 

```{r echo=FALSE, Univariate_Plots}
head(wine)
```
**Initial Observation**
 - Clearly we can see how all of our data is numeric. 

Lets explore the dimensions of the dataset, which will give us an idea on how 
big is the dataset. 

```{r echo=FALSE, Univariate_Plot1}
dim(wine)
```

Now, lets dig a bit deeper and see the structure of the dataset by using str \
method

```{r echo=FALSE}
str(wine)
```

**Initial Observation**
 - Data is not only numerical but integer too.

Last but not least, let's take a look to the Summary of the dataset

```{r echo=FALSE}
summary(wine)
```

**Initial Observation**: initially our data looks good, but I would 
be interested to explore why free and total sulfur dioxide have such a big 
amounts on relation to other variables

Now lets explore with some charts, starting with Alcohol levels

```{r echo=FALSE}
ggplot(aes(x=alcohol), data=wine, ) +
  geom_histogram(color = 'black', fill='#d6e8d5', binwidth = 0.5)
```

**Initial Observation**
 - It seems there is few relevant data points and binwidths we might 
 want to check a  bit further for that let's summarise alcohol variable 
 
```{r echo=FALSE}
summary(wine$alcohol)
```

Let's set some limits to the data that we are observing 

```{r echo=FALSE}
ggplot(aes(x=alcohol), data=subset(wine, !is.na(alcohol))) +
  geom_histogram(color = 'black', fill='#d6e8d5', binwidth = 0.1) + 
  coord_cartesian(xlim=c(8.00,14.20),ylim=c(0,250)) 
```

**Initial Observation**
- Now the data seems to be more uniform and even show a pattern

Let's keep exploring other variables, such as volatic acidity 
which is the amount of acetic acide and might influence taste

```{r echo=FALSE}
ggplot(aes(x=volatile.acidity), data=wine ) +
  geom_histogram(color = 'black', fill='#ffecc9', binwidth = 0.05)
```

Same as before, checking the summary will give a better idea on limits 
for the x axis

```{r echo=FALSE}
summary(wine$volatile.acidity)
```
```{r echo=FALSE}
ggplot(aes(x=volatile.acidity), data=wine ) +
  geom_histogram(color = 'black', fill='#ffecc9', binwidth = 0.03) +
  coord_cartesian(xlim=c(0.0800,1.1000),ylim=c(0,800)) 
```

It seems the data is a bit skewed to the right, let's plot it to see if there 
is any outiers

```{r}
ggplot(aes(x = "", y = volatile.acidity),data = wine) + 
  geom_boxplot() +
  coord_cartesian(ylim = c(0.0800,1.100)) 
```

**Observation**:
- With the boxplot in place we clearly can see there is outliers that lie down 
outside the quantiles, specifically the third quartile. 

For that we can limit again our previous plot :) 

```{r echo=FALSE}
ggplot(aes(x=volatile.acidity), data=wine ) +
  geom_histogram(color = 'black', fill='#ffecc9', binwidth = 0.03) +
  coord_cartesian(xlim=c(0.0800,0.6),ylim=c(0,800))
```

**Initial Observation**
- Now the data seems to be more uniform and even show a pattern

We know from a fact that residual sugar might have influence in the levels of 
alcohol, so let's check this variable too

```{r echo=FALSE}
ggplot(aes(x=residual.sugar), data=wine ) +
  geom_histogram(color = 'black', binwidth = 5) 
```

It seems we need to adjust a bit of bidwith and the limits of both axis

```{r echo=FALSE}
summary(wine$residual.sugar)
```

With the maximum and minimum values,lets limit the axis and plot it

```{r echo=FALSE}
ggplot(aes(x=residual.sugar), data=subset(wine, !is.na(residual.sugar))) +
  geom_histogram(color = 'black', binwidth = 0.05) +
  coord_cartesian(xlim=c(0.6,35),ylim=c(0,350)) + 
  scale_x_log10()
  
```

Now, let's check the total sulfure dioxide

```{r echo=FALSE}
ggplot(aes(x=total.sulfur.dioxide), data=wine ) +
  geom_histogram(color = 'black', fill='#253647', bins = 20) 
```

```{r echo=FALSE}
summary(wine$total.sulfur.dioxide)
```

```{r echo=FALSE}
ggplot(aes(x=total.sulfur.dioxide), data=subset(wine, !is.na(total.sulfur.dioxide))) +
  geom_histogram(color = 'black', fill='#253647', binwidth = 5) +
  coord_cartesian(xlim=c(9,440.0),ylim=c(0,280))
  
```

Now lets explore 2 more features, one of them is quality which is our output 
variable or independent variable. 

```{r echo=FALSE}
ggplot(aes(x=quality), data=wine ) +
  geom_bar(color = 'black', fill='#253647') 
```


```{r echo=FALSE}
# Let's plot the histogram with each bar colored with Quality as a factor
# with a different dataframe so still can play around with the original dataset
# in the next observations

wine.q.factor <- wine
wine.q.factor$quality <- factor(wine.q.factor$quality, ordered = T)

ggplot(aes(x=quality), data=wine.q.factor ) +
  geom_bar(aes(fill = factor(quality)))
```

**Observation** 

- It's interesting to see how 95% of the data is heavily concentrated on the 
observations with quality between 5 and 7. 

Also, let's plot Density as one of the no main features selected, but after 
reflecting in previous iterations considered is important to give context
to the main user who might be checking the project. 

```{r echo=FALSE}
ggplot(aes(x=density), data=wine ) +
  geom_bar(color = 'black', fill='#253647') 
```

Lets check the summary of density, so we can limit the axis and have a better 
view of the data 

```{r}
summary(wine$density)
```

```{r echo=FALSE}
# As we have many observations with low values for the density 
# we need to adjust the binwidth so we have a better overview of the 
# distribution

ggplot(aes(x=density), data=subset(wine, !is.na(total.sulfur.dioxide))) +
  geom_histogram(color = 'black', fill='#253647', binwidth = 0.0005) +
  coord_cartesian(xlim=c(0.9871,1.001),ylim=c(0,350)) + 
  scale_x_continuous(breaks=seq(0.98721,1.001,0.0025))
  
```

**Observation**
- We can see that density is heavily concentrated and also between each value of
x axis as we have scale continuosly we can observe the values are pretty minimal

# Univariate Analysis

### What is the structure of your dataset?
The structure of the dataset is  composed of4898 observations (rows) and 13
variables (columns)

### What is/are the main feature(s) of interest in your dataset?
The main features of interest in my dataset are: 
- Alcohol 
- Volatic Acidity 
- Residual sugar
- Total sulfur dioxide

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?
- Sulfates which might contribute to total sulfur dioxide levels

### Did you create any new variables from existing variables in the dataset?
- No. I have not created any new variables initially.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?
- I did apply some adjustments of the bins and binwidht on the data, specifically
for the alcohol and volatic.acidity of the wine, since I wanted to check how the 
data was spread out in the distribution and noticed difference that makes to 
adjust limits between axis and make the scale different. 
- Yes, when plotting the quality as an histogram, one interesting finding was
the fact that 95% of the data lies down around 5 to 7 scores in quality, which 
makes me wonder if the data is not representative of the whole population or 
if the sampling was somehow bias :) 


# Bivariate Plots Section

On this section we will explore relationships between two variables, initially
we will start to explore the table of correlation coeficients, then we will 
continue to explore the the main features selected to then explore also the \ 
relationship between those variables that were not selected as main features.

```{r echo=FALSE }
cr <- rcorr(as.matrix(wine))
cr$r
```

**Initial Observations** 
 
 It seems pretty clear that some of the asumptions about relationships between / 
 variables selected as main ( residual.sugar, alcohol, volatic.acidity and 
 total.sulfur.dioxide) might been well chosen as its coefficients show certain 
 correlation. 
 
 Such as: 
 
 - Alcohol - Residual.Sugar --> -0.4506
 - total.sulfur.dioxide - Residual.Sugar --> 0.401
 - Alcohol - total.sulfur.dioxide --> -0.448
 
 Also, it has been observed that there is a tendency on strong correlation on 
 other variables that were not picked up and interestingly enough came out in 
 the table with correlation. Lets add them to our list for exploration
 
 - Density - residual.sugar --> 0.838
 - Density - alcohol --> -0.780
 - Density - total.sulfur.dioxide --> 0.529
 
  Correlation between main features vs. Dependent variable ( Quality )
 
 - Volatic.Acidity - Quality --> -0.19
 - Alcohol - Quality --> 0.435
 
 As we can see above, density seems an interesting strong correlated variable
 with many of the main features already selected, therefore we will include it 
 into the analysis.
 
 With this information we can proceed further in our investigation on how 
 this physio-chemical components might affect or not the quality of the wine 
 and also the components itself might react.

Let's start by plotting first the correlations between Alcohol and Residual 
Sugar 

```{r echo=FALSE }
ggplot(aes(x=alcohol, y=residual.sugar), data = wine) + 
  geom_point(alpha=1/4, color='blue', fill='blue') + 
  xlim(8,15) 
summary(wine$alcohol)
```

It seems that as the alcohol level increases the residual sugar after \
fermentation rarely goes above 20 grams/liter, and also within the 
scatter plot looks a bit of decrease as the alcohol level goes up.

Let's see if by applying geosmooth function we are right in our asumption

```{r echo=FALSE }
ggplot(aes(x=alcohol, y=residual.sugar), data = wine) + 
 geom_line(position=position_jitter(h=0)) + geom_smooth()
```

Something seems still a bit off, lets try to do a bit more work by applying 
a transformation on the y variable, alcohol is being expressed in % meanwhile 
sugar is being expressed as grames per liter 


```{r echo=FALSE }
ggplot(aes(x=alcohol, y=(residual.sugar/1000)*100), data = wine) + 
  geom_line(position=position_jitter(h=0),stat='summary', fun.y=mean) + 
  geom_smooth()
```

Here we can observe a more clear pattern on how the levels of sugar seems to 
decrease as the level of alcohol increase, starting with around 1.5% level and 
progressively and slowly decreasing until 0.5% and less.

Lets proceed further with the analysis for: total.sulfur.dioxide and 
Residual.Sugar

```{r echo=FALSE }
ggplot(aes(x=residual.sugar ,y=total.sulfur.dioxide), data = wine) + 
  geom_point(alpha=1/2, color='#96b585', fill='#96b585') +
  xlim(0.6,66) + 
  ylim(9,440)
summary(wine$residual.sugar)
summary(wine$total.sulfur.dioxide)
```

Even though there might be a strong correlation, it's still not clear based on 
the plot, so let us check how the scales are represented for both axis by 
reviewing the facts.

- We know already residual sugar is grams/per liter. 
- In the other hand, total.sulfur.dioxide is described as the amount of free 
and bounds forms of SO2, which is represented usually in ppm ( Part per million)

Therefore we might want to transform it to a common scale which will be 
ppm to grames/perliter 

```{r echo=FALSE }
ggplot(aes(x=residual.sugar ,y=(total.sulfur.dioxide/1000)), data = wine) + 
  geom_point(alpha=1/3, color='#96b585', fill='#96b585') +
  xlim(0.6,30)
```

Our data is better spread out now that we have adjusted the scales. 
Nevertheless there seems to be a strong positive correlation between both variables
I would be interested to see if we can get a bit more information by plotting 
with conditional means

```{r echo=FALSE}
wine$tt.sulfur.grm.liter <- wine$total.sulfur.dioxide / 1000

wine.sugar_dioxide <- wine %>% 
  group_by(residual.sugar) %>% 
  summarise(total_mean=mean(tt.sulfur.grm.liter),
          total_median=median(tt.sulfur.grm.liter),
          n=n()) %>% 
  arrange(residual.sugar)

```

```{r echo=FALSE}
ggplot(aes(x=residual.sugar, y=total_mean), data=wine.sugar_dioxide) +
  geom_line(position=position_jitter(h=0)) +
  xlim(0.6,30) + geom_smooth(method='lm')
```

In order to do this plot, a new feature has been added, so next plots will be
easily computed. The new feature is above ppm being transformed to grams/liter 

Now lets proceed to explore our main features with other features that it might 
be interesting from what we found in the correlations

 - Density - residual.sugar --> 0.838
 - Density - alcohol --> -0.780
 - Density - total.sulfur.dioxide --> 0.529

```{r echo=FALSE }
ggplot(aes(x=residual.sugar, y=density), data = wine) + 
  geom_point(alpha=1/4) +
  xlim(0.6, 65.8) 
summary(wine$residual.sugar)
```

From the plot above we could infere there is a relation between the residual 
sugar and density. 

From its definition: the density of water is close to that of water depending on
the percent alcohol and sugar content

Confirming that density depends on this 2 other variables, Let's get a deeper 
understanding by checking its summary first.

```{r}
summary(wine$residual.sugar)
```

```{r}
summary(wine$density)
```

And plot it with better limits to see how is spread out. 

```{r}
ggplot(aes(x=residual.sugar ,y=density), data = wine) + 
  geom_point(alpha=1/4, color='#6b4c72', fill='#6b4c72') +
  xlim(0.6, quantile(wine$residual.sugar , p=0.95)) +
  ylim(0.9871, quantile(wine$density, p=0.95)) +
  geom_smooth(method = 'lm', color = '#272963')
```

On this plot, the distribution of the data clearly show us a pattern of the
strong positive correlation between both variables.

It is important to notice if applying a linear regression for modeling and 
predicting data such as Quality of the wine, I would probably be leaving 
out variables with such an strong correlation as it might affect the 
prediction.

Now that we have some insights on how dependant density might be of alcohol 
let's apply the same exploration on this 2 variables 

```{r echo=FALSE }
ggplot(aes(x=alcohol, y=density), data = wine) + 
  geom_point(alpha=1/4) + 
  xlim(8,15) 
```

We could observe, it seems there is a negative correlation between both 
variables. Let's apply again some quantiles and smooth to the graph 

```{r}
ggplot(aes(x=alcohol ,y=density), data = wine) + 
  geom_point(alpha=1/4, color='#ea3c6b', fill='#ea3c6b') +
  xlim(8, quantile(wine$alcohol , p=0.95)) +
  ylim(0.9871, quantile(wine$density, p=0.95)) +
  geom_smooth(method = 'lm', color = '#7a6f72')
```

It is quite evident that alcohol plays an important role on being stronly and
negative correlated to the level of density. 

Last but not least on this exploration of this 3 main features against not 
main features variables let's check total.sulfur.dioxide with density

```{r echo=FALSE }
ggplot(aes(x=total.sulfur.dioxide, y=density), data = wine) + 
  geom_point(alpha=1/4) +
  xlim(9, 440.0) 
summary(wine$total.sulfur.dioxide)
```

Same as before let's focus where our data is highly concentrated and apply
quantiles along with smooth to the plot. 

```{r}
ggplot(aes(x=total.sulfur.dioxide ,y=density), data = wine) + 
  geom_point(alpha=1/4, color='#1aafa8', fill='#1aafa8') +
  xlim(9, quantile(wine$total.sulfur.dioxide , p=0.95)) +
  ylim(0.9871, quantile(wine$density, p=0.95)) +
  geom_smooth(method = 'lm', color = '#7a6f72')
```

Our scale is different as the scales for both variables are different, 
lets do a transformation and plot it again to see how it vary 

   - total sulfur dioxide (mg / dm^3)
   - density (g / cm^3) --> le'ts transform to mg / dm^3 by multiplying by 1000
   
```{r}
# Lets transform the density from g/cm3 to mg/dm3 so we can have the same 
# units as total.sulfur.dioxide. 

# The new variable is being called: density_in_mg and it's the representation 
# of the density divided by 1000 

wine$density_in_mg <- wine$density * 1000

summary(wine$density_in_mg)

```  

```{r}
ggplot(aes(x=total.sulfur.dioxide ,y=density_in_mg), data = wine) + 
  geom_point(alpha=1/4, color='#1aafa8', fill='#1aafa8') +
  xlim(9, quantile(wine$total.sulfur.dioxide , p=0.95)) +
  ylim(987.1, quantile(wine$density_in_mg, p=0.95)) +
  geom_smooth(method = 'lm', color = '#7a6f72')
```

After transformating the density variable to mg, it's being observed that 
distribution of relationship between the two variables remain the same. 

We are also interested to evaluate how alcohol might be related to the 
perception and quality of the wine, knowing that quality 
was scored in the dataset from 0 to 10 

```{r echo=FALSE }
ggplot(aes(x=alcohol, y=quality), data = wine) + 
  geom_point(alpha=1/4) + 
  xlim(8,14.2)
summary(wine$alcohol)
```

Something is not clear to me with this scatterplot, let's appy some changes 
to improve our charts :) first, we need to transform quality to a factor then we 
can produce boxplot we get a better picture of alcohol vs. quality.

```{r}
# Lets represent quality as a factor which is ordered
wine$quality <- factor(wine$quality, ordered = T)
```


```{r}
ggplot(aes(x=quality, y=alcohol), data=wine) + 
  geom_boxplot() + 
  geom_smooth(method='lm')
```

There is some interesting finding on thix plot, for example: 

- There is some outliers when quality was score at a 5 
- On having a quality 3, more the majority of data falls in 25% to 50% with a 
  9 to 10~ % in alcohol. 
- The distribution of data was fairly equal for data scored a 6 or a 7 in quality 
- Anothe intesting finding is how only an small set of the data was score with a 
 9 and it falls within the maximum percentage levels of alcohol 

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

I have noticed certain correlations between the main features and the 
the other features that hasn't been picked, such  as density. It appears 
main features such as residual sugar, alcohol and total sulfur dioxide might
affect the density of the wine. 

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

Yes, definitely there is some interesting relationships, for example 
the quality of the wine and the levels of alcohol, which makes me think 
if actually people sentiment about alcohol is: the more percentage of alcohol 
the wine have the more higher is being scored the quality of the wine.

### What was the strongest relationship you found?
The strongest relationship that has been found is a positive strong relation 
between Residual Sugar and Density with a coefficient of 0.83 and the 
representation of the plots, it is prudent to say that is the strongest relationship 
found along features.

# Multivariate Plots Section

Before starting our multivariate analysis there is 2 actions that are needed in 
order to proceed forward and have really meaningful information. 

First, before starting, let's do a scatterplot matrix 

```{r fig.height = 6, fig.width = 10}
theme_set(theme_minimal(20))

# Let's create a vector to exclude newly created variables and 
# the observation number
names_to_exclude <- c('X', 'tt.sulfur.grm.liter', 'density_in_mg','quality')

set.seed(1836)
# Now let's create the subset with all variables except 
# the ones present in names_to_exclude so we can create the matrix
wine_subset <- wine[ , !names(wine) %in% names_to_exclude]

names(wine_subset)
ggpairs(wine_subset[sample.int(nrow(wine_subset),1000), ]) + 
  theme(axis.text.x = element_text(size=7),
        axis.text.y = element_text(size=7),
        axis.ticks = element_blank(), 
        legend.text = element_text(size=7),
        strip.text = element_text(size=7),
        strip.text.y  = element_text(size=7, angle=0))
```


*Observation* 
After running the scatter plot matrix, it is settled the variables we will 
work with are the ones selected as main features, additionally we will add to
the analysis the following variables too: density, quality and ranking. 

First, let's try to plot residual alcohol and residual sugar along with quality
where quality is greater than 7, as for now we want to evaluate the wines 
that were ranked with High Quality 

```{r}
ggplot(aes(x=alcohol, y=residual.sugar), data=subset(wine, wine$quality>7)) +
  geom_point(aes(color=quality), stat='summary', fun.y = mean) + 
  geom_smooth(alpha=1/4, color='gray')
```

Now lets check one of the strongest correlations which is between residual sugar
and density 

```{r}
ggplot(aes(x=residual.sugar, y=density),
       data = subset(wine, quality >= 7 & !is.na(residual.sugar))) + 
       geom_line(aes(color=quality), stat='summary', fun.y=mean) +
       geom_line( linetype=3, stat='summary', fun.y=mean) + scale_x_log10()
```

Even thought that the patter is not straight forward we can see that even for 
high quality wines, as the residual.sugar is increasing the density is affected 
by it, for the 3 most high quality wines the pattern seems to be the same 
except for the best ( scored as 9 ) which seems to be more linear and less noisy

Now, lets check the other strongest correlation which is between density and 
alcohol. 

```{r}
ggplot(aes(x=alcohol, y=density),
       data = subset(wine, quality >= 7)) + 
   geom_point(aes(color=quality), stat='summary', fun.y = mean) + 
  geom_smooth(alpha=1/4, color='gray')
```

This strong negative relationship is particularly a good focus of attention for
further analysis in other projects if possibles

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

This section was really interesting in terms of relationships between main 
features, such as alcohol and residual sugar and how it might impact 
explicitly or not the quality of the wine. 


### Were there any interesting or surprising interactions between features?

Yes, there is a particular interaction that I would probably investigate further
in next iteration of the project. 

We know by facts, that there is strong correlation between residual sugar and 
density also, between alcohol and density. 

As we have read previously over the previous sections density has higher chances
of variability when influenced by % of alcohol and residual sugars, then If 
we look at the multivariate analysis we could see how this 3 variables are 
strongly correlated and it will be subject of study to add/remove some of them 
from the prediction models (when done) to see how it performs the regression and 
its accuracy. 

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}
# The idea of this plot is to express the % levels of alcohol vs residual.sugar 
# but residual.sugar is represented in g/dm3 so for that the actions are: 
# - Divided by 1000 to pass it to mg and multiply by 100 to obtain percentage
# value
# - We want to plot the mean of the Y variable so the chart
# - Also we apply geom_smooth to see if the any patters within the plot

ggplot(aes(x=alcohol, y=(residual.sugar/1000)*100), data = wine) + 
  geom_line(position=position_jitter(h=0),stat='summary', fun.y=mean, color='blue') + 
  geom_smooth(color='#6b7077') + 
  xlab("Alcohol (%)") + 
  ylab("Residual Sugar (%)") + 
  ggtitle("% Levels of Alcohol vs. Residual Sugar ")  + 
  theme(plot.title = element_text(size = 12, hjust=0.5),
             axis.text=element_text(size = 10),
             axis.title.y = element_text(angle=0,size=10, vjust=0.5),
             axis.title.x = element_text(size=10)
        )
```

### Description One
The reason for choosing this plot initially is as a social drinker I was curious
to see how the percentage level of alcohol present in alcoholic drinks, in this 
case wine influence the taste of drink, specially as sweetner ( sugar levels ). 
This was the starting point of the analysis, by observing as the % of alcohol 
levels increase the residual sugars decrease, which might be product also of the 
fermentation levels and times. It would be pretty interesting to collect more
data points on features such as fermentation levels, and time to ferment. 

### Plot Two
```{r echo=FALSE, Plot_Two}
# On the code below there is a series of actions taken in order 
# to represent the correlation a bit better, please follow the explanation: 
# 1. X variable=Residual.Sugar was limited by its mininum value 
# whih is 0.6 and its 95% quantile so we can get rid of outliers and check where 
# the concentration of the data is. 
# 2. Y variable=Density was also limited for the same reason above minimum value
# and 95% quantile 
# 3. A geom_smooth was applied with LM method so patters could be detected

ggplot(aes(x=residual.sugar ,y=density), data = wine) + 
  geom_point(alpha=1/4, color='#6b4c72', fill='#6b4c72') +
  xlim(0.6, quantile(wine$residual.sugar , p=0.95)) +
  ylim(0.9871, quantile(wine$density, p=0.95)) +
  geom_smooth(method = 'lm', color = '#272963') + 
  xlab("Residual Sugar (g/dm3) ") + 
  ylab(" Density (g/cm3) ") + 
  ggtitle("Density vs. Residual Sugar correlation") + 
  theme(plot.title = element_text(size = 12, hjust=0.5),
             axis.text=element_text(size = 10),
             axis.title = element_text(size=10),
             axis.title.y = element_text(angle=0, vjust=0.5))
```

### Description Two
In order to follow the exploration and research on the dataset, the next plot 
I decided to focus on was the correlation between residual sugar and density.

The reason for it is well known that density is a measurement of mass, 
weight or per volume of a material and it's mainly determined by other
components such as alcohol levels, residual sugar, glycerol 
among others [[1]](https://www.etslabs.com/analyses/DEN)

As a matter of facts, we can see on the plot above the strong positive correlation
between Residual sugar and Density, which confirms once again the dependency of
density with other variables present in the dataset.

### Plot Three
```{r echo=FALSE, Plot_Three}
# defining a better palette for this plot
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

ggplot(aes(x=alcohol, y=density),
       data = subset(wine, quality >= 7)) + 
   geom_point(aes(color=quality), stat='summary', fun.y = mean) + 
  geom_smooth(alpha=1/4, color='blue') +
       xlab('Alcohol (%)') + 
       ylab('Density (g/cm3)') + 
       ggtitle('Multivariate Analysis Alcohol vs. Density by Qualcity', subtitle = 'Quality above 7') + 
       theme(plot.title = element_text(size = 12, hjust = 0.5),
             plot.subtitle = element_text(size= 9, hjust=0.5),
             axis.text=element_text(size = 10),
             axis.title = element_text(size=10),
             legend.text = element_text(size=10),
             legend.title = element_text(size=10), 
             axis.title.y = element_text(angle=0, vjust=0.5)) + scale_colour_manual(values=cbPalette)
```


### Description Three
Last but not least, I wanted to explore the relationship between one of the main
features that was picked from the beggining and another feature that wasn't 
considered initially, along with the Quality that is the dependent variable. 

It was pretty surprising to see how for the 3 highest ranked/scored quality 
wines the increase on percentage of alcohol might be an important factor that 
will influence the density on the wine. Although there were not exploration 
on the density against the quality, it will be worth exploring this on next steps
or iterations of the project. 

------

# Reflection

The exploratory data analysis project on the white wine dataset and the whole 
subject was a pretty overwhelming and exciting journey. On this particular case
the exploration was initially based on certain bias that I wanted to cover in 
relation how influyent is the sugar in drinks with alcohol and thanks to it I'm 
more aware now how multiple physio chemical conditions are important on the 
process of wine making and how it could potentially affect the quality itself. 

To me was surprising to know that the more % of alcohol on the wine, there is a 
change the levels of sugar are less and less, an hypothesis for this might be 
to investigate how fermentation plays a role on this relationship. 

One of the struggles I had to go over was investigating the scale and meaning of 
the units for the features and apply somehow scaling of the features
as well as trying to make the visualisations more friendly. 
